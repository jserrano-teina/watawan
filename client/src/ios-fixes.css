/* 
  iOS-FIXES CSS
  Este archivo contiene soluciones específicas para problemas SÓLO en iOS 
  Actúa como una segunda capa sobre pwa-fixes.css
*/

/* Selector específico para Safari en iOS en modo standalone */
@supports (-webkit-touch-callout: none) {
  @media (display-mode: standalone), (display-mode: fullscreen) {
    /* ===== CORRECCIONES CRÍTICAS PARA LAYOUT DE iOS ===== */
    
    /* Viewport y root fijos para evitar scroll indeseado */
    html, body {
      position: fixed !important;
      width: 100% !important;
      height: 100% !important;
      overflow: hidden !important;
      -webkit-text-size-adjust: 100% !important;
      background-color: #121212 !important;
    }
    
    /* Root container con overflow controlado */
    #root {
      position: absolute !important;
      top: 0 !important;
      left: 0 !important;
      width: 100% !important;
      height: 100% !important;
      overflow-y: auto !important;
      overflow-x: hidden !important;
      -webkit-overflow-scrolling: touch !important;
      overscroll-behavior-y: none !important;
      padding-top: env(safe-area-inset-top, 0) !important;
      padding-bottom: calc(72px + env(safe-area-inset-bottom, 0)) !important;
    }
    
    /* ===== CORRECCIÓN PARA NAVBAR ===== */
    /* Asegurar que la navegación inferior esté fija y con color sólido */
    .fixed-navigation {
      position: fixed !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      /* Reducimos z-index para que no aparezca sobre modales */
      z-index: 50 !important;
      height: auto !important;
      background-color: #1a1a1a !important; /* Color sólido exacto del diseño */
      border-top: 1px solid #333 !important;
      transform: none !important; /* Prevenir transforms que puedan ocultarla */
      opacity: 1 !important;
      visibility: visible !important;
      padding-bottom: env(safe-area-inset-bottom, 0) !important;
    }
    
    /* Fix específico para los textos en la navbar */
    .fixed-navigation span,
    .fixed-navigation button span,
    .tab-name {
      display: block !important;
      visibility: visible !important;
      opacity: 1 !important;
      color: inherit !important;
      margin-top: 4px !important;
      font-size: 12px !important;
      position: relative !important;
      z-index: 1 !important;
      pointer-events: auto !important;
      user-select: none !important;
      -webkit-user-select: none !important;
      transform: translateZ(0) !important;
      backface-visibility: visible !important;
      -webkit-font-smoothing: antialiased !important;
      -moz-osx-font-smoothing: grayscale !important;
      height: auto !important;
      min-height: 14px !important;
    }
    
    /* ===== CORRECCIONES PARA MODALES Y SHEETS ===== */
    /* Forzar que los Sheets lleguen hasta arriba pero respeten safe areas */
    [data-radix-popper-content-wrapper] {
      position: fixed !important;
      inset: 0 !important;
      height: 100% !important;
      width: 100% !important;
      max-height: 100% !important;
      /* Aseguramos que esté por encima de la navbar */
      z-index: 100 !important;
      overflow: hidden !important;
    }
    
    /* Fix específico para modales y sheets para que estén por encima de la navbar */
    .modal-container, 
    [data-state="open"],
    .modal-content,
    .sheet-content,
    [data-radix-popper-content-wrapper],
    [data-id="sheet-content"],
    [role="dialog"],
    .fixed.inset-0,
    [role="presentation"],
    [data-state="open"] > *,
    [data-id="sheet-content"] > * {
      z-index: 9999 !important;
      position: relative !important;
      transform: translateZ(0) !important;
    }
    
    /* Forzar que los modales estén siempre por encima de todo */
    [role="dialog"]::before {
      content: "" !important;
      position: fixed !important;
      top: 0 !important;
      left: 0 !important;
      right: 0 !important;
      bottom: 0 !important;
      background: rgba(0,0,0,0.5) !important;
      z-index: 9998 !important;
      pointer-events: none !important;
    }
    
    /* Estilo específico para el contenedor del Sheet en iOS para asegurar posicionamiento correcto */
    .ios-sheet-fix {
      position: fixed !important;
      bottom: 0 !important;
      left: 0 !important;
      right: 0 !important;
      z-index: 9999 !important;
      max-height: 90vh !important;
      border-top-left-radius: 16px !important;
      border-top-right-radius: 16px !important;
      transform: none !important;
    }
    
    /* Para el bottom sheet específicamente */
    [data-state="open"][data-side="bottom"] {
      border-top-left-radius: 16px !important;
      border-top-right-radius: 16px !important;
      top: auto !important; /* No forzar desde arriba */
      padding-top: 16px !important;
      padding-bottom: calc(16px + env(safe-area-inset-bottom, 0)) !important;
      background-color: #121212 !important;
    }
    
    /* Modal content asegurando que hay espacio para safe areas */
    .modal-content {
      padding-top: env(safe-area-inset-top, 0) !important;
      padding-bottom: env(safe-area-inset-bottom, 0) !important;
    }
    
    /* ===== FIX PARA ÁREA FANTASMA BAJO LA NAVBAR ===== */
    /* Asegurar que no haya espacio extra bajo la navbar */
    .fixed-navigation::after {
      content: "" !important;
      position: fixed !important;
      left: 0 !important; 
      right: 0 !important;
      bottom: 0 !important;
      height: env(safe-area-inset-bottom, 0) !important;
      background-color: #1a1a1a !important; /* Mismo color exacto que navbar */
      z-index: 39 !important; /* Justo debajo de la navbar */
    }
    
    /* Ajustar la altura del contenedor con padding específico para evitar espacios extras */
    .fixed-navigation > div {
      padding-bottom: 0 !important;
      margin-bottom: 0 !important;
      height: 72px !important;
      max-height: 72px !important;
      min-height: 72px !important;
      overflow: visible !important;
      display: flex !important;
      align-items: center !important;
      justify-content: space-around !important;
    }
    
    /* Ajuste específico para botones de la navbar en iOS */
    .fixed-navigation button {
      padding-top: 8px !important;
      padding-bottom: 8px !important;
      height: auto !important;
      min-height: 60px !important;
      max-height: 72px !important;
      display: flex !important;
      flex-direction: column !important;
      align-items: center !important;
      justify-content: center !important;
    }
    
    /* Ajustes para los iconos de la navbar */
    .fixed-navigation button svg {
      margin-bottom: 4px !important;
      display: block !important;
      width: 20px !important;
      height: 20px !important;
    }
    
    /* Estilos específicos para forzar la visibilidad de los nombres de los tabs */
    .tab-name {
      font-weight: 500 !important;
      letter-spacing: 0.2px !important;
      text-shadow: 0 0 1px rgba(255,255,255,0.5) !important; /* Mejora legibilidad */
      display: block !important;
      width: 100% !important;
      text-align: center !important;
    }
    
    /* ===== MEJORAR INTERACTIVIDAD ===== */
    button, a, input, textarea, [role="button"] {
      cursor: pointer !important;
      touch-action: manipulation !important;
      -webkit-tap-highlight-color: transparent !important;
    }
    
    input, textarea {
      -webkit-user-select: text !important;
      user-select: text !important;
    }
  }
}